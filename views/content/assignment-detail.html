<form name="formName" ng-submit="submit(formData);">
    <div class="heading-sec">
        <div class="row">
            <div class="col-md-12 column">
                <div class="heading-profile">
                    <toggle-switch ng-model="formData.status" class="switch-small switch-success pull-right"></toggle-switch>
                    <h2>Create Assignment</h2>
                </div>
            </div>
        </div>
    </div>
    <!-- Top Bar Chart -->
    <div class="panel-content">
        <div class="row">
            <div class="col-md-12">

                <div class="widget">
                    <div class="form-elements-sec">
                        <div class="sec">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Company Name*</label>
                                        <multiple-select name="name" required ng-model="formData.name" ng-name="name.name" api="searchCompany"></multiple-select>
                                        <div class="error-msg" ng-show="formName.name.$invalid">Please Select Company Name</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Company Code*</label>
                                        <input type="text" class="form-control" name="companyCode" ng-model="formData.companyCode" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Type of Claim*</label>
                                        <multiple-select name="typeOfClaim" required ng-model="formData.typeOfClaim" ng-name="name.typeOfClaim" api="searchTypeOfClaim"></multiple-select>
                                        <div class="error-msg" ng-show="formName.typeOfClaim.$invalid">Please Select Type of Claim </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Nature of Survey*</label>
                                        <multiple-select name="natureOfSurvey" required ng-model="formData.natureOfSurvey" ng-name="name.natureOfSurvey" api="searchNatureOfSurvey"></multiple-select>
                                        <div class="error-msg" ng-show="formName.natureOfSurvey.$invalid">Please Select Nature of Survey</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Branch Office*</label>
                                        <multiple-select name="branchOffice" required ng-model="formData.branch" filter='{"company":"{{formData.name}}"}' ng-name="name.branch" api="searchBranch"></multiple-select>
                                        <div class="error-msg" ng-show="formName.branchOffice.$invalid">Please Select Branch Office</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Attach Appointment Mail</label>
                                        <upload-image ng-model="formData.appointment"></upload-image>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Date of Intimation*</label>
                                        <div class="input-group">
                                            <input type="text" name="dateOfIntimation" required class="form-control" uib-datepicker-popup="{{format}}" ng-model="formData.dateOfIntimation" is-open="popup.dateOfIntimation" ng-change="chageDOB(formData.birthDate)" datepicker-options="dateOptions" readonly/>
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default" ng-click="popup.dateOfIntimation = true">
                                                    <i class="fa fa-calendar"></i>
                                                </button>
                                            </span>
                                        </div>
                                        <div class="error-msg" ng-show="formName.dateOfIntimation.$invalid && formName.dateOfIntimation.$touched">Please Enter Date of Intimation</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                  <div class="form-group">
                                    <label>Intimated loss*</label>
                                    <input type="text" name="intimatedLoss" ng-model="formData.intimatedLoss" class="form-control" required>
                                    <div class="error-msg" ng-show="formName.intimatedLoss.$invalid && formName.intimatedLoss.$touched">Please Enter Intimated Loss</div>
                                  </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Appointed by*</label>
                                        <multiple-select name="appointedBy" required ng-model="formData.appointedBy" filter='{"branch":"{{formData.branch}}"}' ng-name="name.appointedBy" api="searchEmployee"></multiple-select>
                                        <div class="error-msg" ng-show="formName.appointedBy.$invalid">Please Select Appointed By</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Owner*</label>
                                        <multiple-select name="owner" required ng-model="formData.owner" filter='{"company":"{{formData.name}}"}' ng-name="name.owner" api="searchAppointedBy"></multiple-select>
                                        <div class="error-msg" ng-show="formName.owner.$invalid">Please Select Owner</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Insured's Office*</label>
                                        <multiple-select name="insuredOffice" required ng-model="formData.insuredOffice" ng-name="name.office" api="searchInsuredOffice"></multiple-select>
                                        <div class="error-msg" ng-show="formName.insuredOffice.$invalid">Please Select Insured's Office</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Insured Officer*</label>
                                        <multiple-select name="insuredOfficer" required ng-model="formData.insuredOfficer" filter='{"company":"{{formData.name}}"}' ng-name="name.office" api="searchOffice"></multiple-select>
                                        <div class="error-msg" ng-show="formName.insuredOfficer.$invalid">Please Select Insured Officer</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Cause of Loss*</label>
                                        <multiple-select name="causeOfLoss" required ng-model="formData.causeOfLoss" ng-name="name.causeOfLoss" api="searchCauseLoss"></multiple-select>
                                        <div class="error-msg" ng-show="formName.siteContact.$invalid">Please Select Cause of Loss</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Nature of Loss*</label>
                                        <ui-select multiple tagging="tagTransform" tagging-label="(press enter to add new)" on-select="clicked($select.selected)" name="natureOfLoss" ng-model="formData.natureOfLoss" theme="bootstrap" required>
                                            <ui-select-match>{{$item.name}}</ui-select-match>
                                            <ui-select-choices repeat="natureOfLoss in natureLoss | filter:$select.search" refresh-delay="0" refresh="refreshNature()">{{natureOfLoss.name}}</ui-select-choices>
                                        </ui-select>
                                        <div class="error-msg" ng-show="formName.natureOfLoss.$invalid && formName.natureOfLoss.$touched">Please Enter Nature Of Loss</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Broker's Office*</label>
                                        <multiple-select name="brokerOffice" required ng-model="formData.brokerOffice" ng-name="name.office" api="searchBroker"></multiple-select>
                                        <div class="error-msg" ng-show="formName.brokerOffice.$invalid">Please Select Broker's Office</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Insurance Policy*</label>
                                        <multiple-select name="insurancePolicy" required ng-model="formData.insurancePolicy" filter='{"company":"{{formData.name}}"}' ng-name="name.office" api="searchOffice"></multiple-select>
                                        <div class="error-msg" ng-show="formName.insurancePolicy.$invalid">Please Select Insurance Policy</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Contact details of Site*</label>
                                        <input type="text" name="siteContact" ng-model="formData.siteContact" class="form-control" required>
                                        <div class="error-msg" ng-show="formName.siteContact.$invalid && formName.siteContact.$touched">Please Enter Contact details of Site</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>Share With</label>
                                        <ui-select multiple tagging="tagTransform" on-select="clicked($select.selected)" name="shareWith" ng-model="formData.shareWith" theme="bootstrap" required>
                                            <ui-select-match>{{$item.name}}</ui-select-match>
                                            <ui-select-choices repeat="natureOfLoss in shareWith | filter:$select.search" refresh-delay="0" refresh="refreshShareWith($select.search)">{{natureOfLoss.name}}</ui-select-choices>
                                        </ui-select>
                                        <div class="error-msg" ng-show="formName.shareWith.$invalid && formName.shareWith.$touched">Please Enter name to Share With</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="widget">
                    <div class="form-elements-sec">
                      <div class="widget-title">
                        <a class="btn btn-primary pull-right" ng-click="addModal('modal-assignment','','products','','',formData.products)">Add New</a>
                          <h3>Products</h3>
                      </div>
                        <div class="sec">
                          <div class="table-responsive">
                              <table class="table table-input" ng-if="formData.products.length!=0">
                                <thead>
                                  <tr>
                                    <th>Product</th>
                                    <th>Item</th>
                                    <th width="150px">Actions</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr ng-repeat="data in formData.products">
                                    <td>{{data.name}}</td>
                                    <td>{{data.item}}</td>
                                    <td>
                                      <a class="btn btn-primary" ng-click="addModal('modal-assignment',$index,'products',data, '',formData.products)">
                                            <i class="fa fa-pencil"></i>
                                        </a>
                                        <a class="btn btn-danger" ng-click="deleteElements($index, formData.products)">
                                            <i class="fa fa-trash"></i>
                                        </a>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                          </div>
                        </div>
                    </div>
                </div>

                <div class="widget">
                    <div class="form-elements-sec">
                      <div class="widget-title">
                        <a class="btn btn-primary pull-right" ng-click="addModal('modal-assignment','','invoice','','',formData.invoice)">Add New</a>
                          <!-- <button class="btn btn-primary pull-right" type="submit" ng-disabled="modelData.$invalid">Add New</button> -->

                          <h3>Invoices</h3>
                      </div>
                        <div class="sec">
                          <div class="table-responsive">
                              <table class="table table-input" ng-if="formData.invoice.length!=0">
                                <thead>
                                  <tr>
                                    <th>Invoice #</th>
                                    <th>Date</th>
                                    <th width="150px">Actions</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr ng-repeat="data in formData.invoice track by $index">
                                    <td>{{data.invoiceNumber}} #</td>
                                    <td>{{data.invoiceNumberDate| date:'dd MMM yyyy'}}</td>
                                    <td>
                                        <a class="btn btn-primary" ng-click="addModal('modal-assignment',$index,'invoice',data, '',formData.invoice)">
                                            <i class="fa fa-pencil"></i>
                                        </a>
                                        <a class="btn btn-danger" ng-click="deleteElements($index, formData.invoice)">
                                            <i class="fa fa-trash"></i>
                                        </a>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                          </div>
                        </div>
                    </div>
                </div>

                <div class="widget">
                    <div class="form-elements-sec">
                      <div class="widget-title">
                        <a class="btn btn-primary pull-right" ng-click="addModal('modal-assignment','','LRs','','',formData.LRs)">Add New</a>
                          <h3>LRs</h3>
                      </div>
                        <div class="sec">
                          <div class="table-responsive">
                              <table class="table table-input" ng-if="formData.LRs.length!=0">
                                <thead>
                                  <tr>
                                    <th>LR #</th>
                                    <th>Date</th>
                                    <th width="150px">Actions</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr ng-repeat="data in formData.LRs">
                                    <td>{{data.lrNumber}} #</td>
                                    <td>{{data.lrNumberDate| date:'dd MMM yyyy'}}</td>
                                    <td>
                                      <a class="btn btn-primary" ng-click="addModal('modal-assignment',$index,'LRs',data, '',formData.LRs)">
                                            <i class="fa fa-pencil"></i>
                                        </a>
                                        <a class="btn btn-danger" ng-click="deleteElements($index, formData.LRs)">
                                            <i class="fa fa-trash"></i>
                                        </a>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                          </div>
                        </div>
                    </div>
                </div>

                <div class="widget">
                    <div class="form-elements-sec">
                      <div class="widget-title">
                        <a class="btn btn-primary pull-right" ng-click="addModal('modal-assignment','','Vehicle','','',formData.vehicleNumber)">Add New</a>
                          <h3>Vehicle Number</h3>
                      </div>
                        <div class="sec">
                          <div class="table-responsive">
                              <table class="table table-input" ng-if="formData.vehicleNumber.length!=0">
                                <thead>
                                  <tr>
                                    <th>Vehicle #</th>
                                    <th width="150px">Actions</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr ng-repeat="data in formData.vehicleNumber">
                                    <td>{{data.vehicleNumber}} #</td>
                                    <td>
                                      <a class="btn btn-primary" ng-click="addModal('modal-assignment',$index,'Vehicle',data, '',formData.vehicleNumber)">
                                            <i class="fa fa-pencil"></i>
                                        </a>
                                        <a class="btn btn-danger" ng-click="deleteElements($index, formData.vehicleNumber)">
                                            <i class="fa fa-trash"></i>
                                        </a>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                          </div>
                        </div>
                    </div>
                </div>


                <div class="widget">
                    <div class="form-elements-sec">
                      <div class="widget-title">
                        <a class="btn btn-primary pull-right" ng-click="addModal('modal-assignment','','Others','','',formData.others)">Add New</a>
                          <h3>Others</h3>
                      </div>
                        <div class="sec">
                          <div class="table-responsive">
                              <table class="table table-input" ng-if="formData.others.length!=0">
                                <thead>
                                  <tr>
                                    <th>Location ID</th>
                                    <th>Product ID</th>
                                    <th width="150px">Actions</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr ng-repeat="data in formData.others">
                                    <td>{{data.locationID}}</td>
                                    <td>{{data.productID}}</td>
                                    <td>
                                      <a class="btn btn-primary" ng-click="addModal('modal-assignment',$index,'Others',data, '',formData.others)">
                                            <i class="fa fa-pencil"></i>
                                        </a>
                                        <a class="btn btn-danger" ng-click="deleteElements($index, formData.others)">
                                            <i class="fa fa-trash"></i>
                                        </a>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                          </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="clearfix"></div>
        <div class="text-center mt20 odd-even-button">
            <button class="btn btn-default" type="submit" ng-disabled="formName.$invalid">Save</button>
            <button class="btn btn-default" ui-sref="assignment-list">Cancel</button>
        </div>
    </div>
</form>
